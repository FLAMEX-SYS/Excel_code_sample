Sub DisplayPivotForm()

    Dim ws As Worksheet
    Dim LastCol As Long
    Dim Header As Range

    Set ws = ThisWorkbook.Sheets("Data Sheet")
    LastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column

    ' Clear previous items and add headers to the listboxes
    With UserForm1
        .lstRows.Clear
        .lstColumns.Clear
        .lstValues.Clear
        .lstFilters.Clear

        For Each Header In ws.Range(ws.Cells(1, 1), ws.Cells(1, LastCol))
            .lstRows.AddItem Header.Value
            .lstColumns.AddItem Header.Value
            .lstValues.AddItem Header.Value
            .lstFilters.AddItem Header.Value
        Next Header

        ' Show the UserForm
        .Show
    End With

End Sub

Private Sub btnGeneratePivot_Click()

    Dim ws As Worksheet
    Dim PivotWs As Worksheet
    Dim LastRow As Long, LastCol As Long
    Dim PivotRange As Range
    Dim PivotTable As PivotTable
    Dim Field As Variant

    Set ws = ThisWorkbook.Sheets("Data Sheet")
    Set PivotWs = ThisWorkbook.Sheets.Add
    PivotWs.Name = "Pivot"

    LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    LastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column

    Set PivotRange = ws.Range(ws.Cells(1, 1), ws.Cells(LastRow, LastCol))

    ' Create Pivot Table
    Set PivotTable = PivotWs.PivotTableWizard(SourceType:=xlDatabase, SourceData:=PivotRange, TableDestination:=PivotWs.Cells(1, 1), TableName:="PivotTable1")

    ' Add selected fields to Pivot Table
    Dim i As Integer

    ' Add selected fields to Rows
    For i = 0 To Me.lstRows.ListCount - 1
        If Me.lstRows.Selected(i) Then
            PivotTable.PivotFields(Me.lstRows.List(i)).Orientation = xlRowField
        End If
    Next i

    ' Add selected fields to Columns
    For i = 0 To Me.lstColumns.ListCount - 1
        If Me.lstColumns.Selected(i) Then
            PivotTable.PivotFields(Me.lstColumns.List(i)).Orientation = xlColumnField
        End If
    Next i

    ' Add selected field to Values
    For i = 0 To Me.lstValues.ListCount - 1
        If Me.lstValues.Selected(i) Then
            PivotTable.AddDataField PivotTable.PivotFields(Me.lstValues.List(i))
        End If
    Next i

    ' Add selected fields to Filters
    For i = 0 To Me.lstFilters.ListCount - 1
        If Me.lstFilters.Selected(i) Then
            PivotTable.PivotFields(Me.lstFilters.List(i)).Orientation = xlPageField
        End If
    Next i

    Me.Hide

End Sub